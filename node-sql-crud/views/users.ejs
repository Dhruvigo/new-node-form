<!DOCTYPE html>
<html>
<head>
  <title>All Users</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

</head>
<body class="container mt-5">
  <h1>All Users</h1>
  <a href="/form" class="btn btn-success mb-3">Create New User</a>
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Age</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% users.forEach(user => { %>
        <tr>
          <td><%= user.id %></td>
          <td><%= user.name %></td>
          <td><%= user.email %></td>
          <td><%= user.age %></td>
          <td>
            <a href="/edit-user/<%= user.id %>" class="btn btn-primary btn-sm">
              <i class="bi bi-pencil-fill"></i> Edit
            </a>
            <button class="btn btn-danger btn-sm" onclick="deleteUser(<%= user.id %>)">
                <i class="bi bi-trash-fill"></i> Delete
              </button>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
  <nav aria-label="Page navigation">
    <ul class="pagination">
      <% if (currentPage > 1) { %>
        <li class="page-item">
          <a class="page-link" href="/users?page=<%= currentPage - 1 %>">Previous</a>
        </li>
      <% } %>
  
      <% for(let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
          <a class="page-link" href="/users?page=<%= i %>"><%= i %></a>
        </li>
      <% } %>
  
      <% if (currentPage < totalPages) { %>
        <li class="page-item">
          <a class="page-link" href="/users?page=<%= currentPage + 1 %>">Next</a>
        </li>
      <% } %>
    </ul>
  </nav>
  
</body>
</html>
<script>
    async function deleteUser(id) {
      if(confirm('Are you sure?')) {
        const res = await fetch(`/users/${id}`, { method: 'DELETE' });
        const data = await res.json();
        alert(data.message);
        location.reload();
      }
    }
  </script>